{% assign docversion = include.docversion %}
{% assign data_source = include.source %}

<div id="guides-app"
     data-url="{{ site.search.url }}"
     data-initial-timeout="{{ site.search.initial-timeout }}"
     data-more-timeout="{{ site.search.more-timeout }}"
     data-min-chars="{{ site.search.min-chars }}"
     data-quarkus-version="{{ docversion }}">
    <section class="full-width-version-bg flexfilterbar">
      <div class="flexcontainer">
        <div class="search">
          <input v-model="text" type="text" placeholder="Filter by keyword" />
        </div>
        <div class="flexlabel">
          <label>By Version</label>
        </div>
        <div class="pulldown version">
          <select id="guidesindex-version-dropdown">
          {% for version in site.data.versions.documentation %}
          <option value="{{ version }}" {% if docversion == version %}selected{% endif %}>{% if version == 'latest' %}{{ site.data.versions.quarkus.version | replace_regex: "\.[0-9+]\.Final", "" }} - {% endif %}{{ version | capitalize }}{% if version == 'main' %} - SNAPSHOT{% endif %}</option>
          {% endfor %}
          </select>
        </div>
      </div>
    </section>

    <div>
      <h1 class="title">{{ page.title }}</h1>
    </div>
    <div v-if="hasInput" class="grid-wrapper guides results vuejs"
         :class="{ empty: !loading && !hasHits, 'vuejs-enabled': true, loading: loading }">
      <div class="grid__item width-12-12 click-cards">
        <Transition name="fade-in">
          <div v-if="!loading && !hasHits" class="empty-placeholder">
            Sorry, no guides matched your search. Please try again.
          </div>
        </Transition>
        <Transition name="fade-in">
            <div v-if="!loading && !hasHits" class="empty-placeholder">
                Sorry, no guides matched your search. Please try again.
            </div>
        </Transition>
        <ul class="list">
          <li>
            <ul class="grid-wrapper list-item">
              <li v-for="card in cardHits"
                  v-html="card.innerHTML"
                  class="card"
                  :class="Array.from(card.classList)">
              </li>
            </ul>
          </li>
        </ul>
        <Transition name="fade-in">
            <div v-if="loading" class="loading-placeholder">
                Loading...
            </div>
        </Transition>
      </div>
    </div>
    <!-- Static content displayed when there is no input in the search form or Javascript is disabled,
         but also used as a source of data for cards displayed by the vue.js app. -->
    <div v-else class="grid-wrapper guides" id="docs">

      <div class="grid__item width-6-12 width-12-12-m guide-categories callout-wrapper">
        <h3>View Category</h3>
          <ul>
          {% for item in site.data[data_source].categories %}
            <li>
              <a href="#{{ item.cat-id }}">{{ item.category }}</a>
            </li>
          {% endfor %}
          </ul>
      </div>

      <div class="grid__item width-6-12 width-12-12-m callout-wrapper">
        <div class="grid-wrapper callout">
           <div class="grid__item width-12-12">
             <h3>Quarkus Cheat Sheet</h3>
           </div>
           <div class="grid__item col">
            <a href="https://lordofthejars.github.io/quarkus-cheat-sheet/" target="_blank">
              <span class="col-icon"><i class="far fa-file-pdf"></i></span>
              <span class="col-link">Download full cheatsheet as PDF</span>
            </a>
           </div>
           <div class="grid__item col">
             <a href="https://developers.redhat.com/search?t=quarkus&f=type%7Echeatsheet" target="_blank">Get more cheatsheets on the Red Hat Developers website <i class="fas fa-external-link-alt"></i></a>
           </div>
        </div>
      </div>

      <div class="grid__item width-12-12 click-cards">
        <ul class="list">
        {% for item in site.data[data_source].categories %}
          <li>
            <h3 id="{{ item.cat-id }}">{{ item.category }}</h3>
            <ul class="grid-wrapper list-item">
            {% for guide in item.guides %}
              {% assign is_external_guide = guide.url | startswith: 'http' %}
              {% if is_external_guide %}
                {% assign guide_url = guide.url %}
              {% elsif docversion == 'latest' %}
                {% assign guide_url = site.baseurl | append: guide.url %}
              {% else %}
                {% assign guide_url = site.baseurl | append: '/version/' | append: docversion | append: guide.url %}
              {% endif %}
              <li class="card">
                  <a href="{{ guide_url }}" {% if is_external_guide %}target="_blank"{% endif %}></a>
                  <p class="title">{{ guide.title }}</p>
                  <div class="description">{{ guide.description | markdownify }}</div>
                  <div class="keywords">{{ guide.keywords }}</div>
                  {% if guide.origin == 'quarkiverse-hub' %}
                  <div class="origin">
                      <img src="/assets/images/quarkiverse_icon_default.svg" width="25" height="25" />
                      <span>Quarkiverse Hub</span>
                  </div>
                  {% endif %}
              </li>
            {% endfor %}
            </ul>
          </li>
        {% endfor %}
        </ul>
        <div class="empty-list">Sorry, no guides matched your search. Please try again.</div>
      </div>
    </div>
</div>
<script src="/assets/javascript/guides-app.js" type="module"></script>
